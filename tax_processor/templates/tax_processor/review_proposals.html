{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ title }}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; vertical-align: top; }
        th { background-color: #f4f4f4; }
        .proposal { background-color: #ffe4b2; } /* Light peach color for proposals */
    </style>
</head>
<body>
<h1>{{ title }}</h1>

{% if messages %}
<ul class="messages" style="list-style: none; padding: 0;">
    {% for message in messages %}
    <li style="color: {% if message.tags == 'success' %}green{% else %}red{% endif %}; margin-bottom: 10px;">{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}

<p>Return to <a href="{% url 'user_dashboard' %}">Dashboard</a> | <a href="{% url 'rule_list' %}">Rule Management</a></p>

{% if proposals %}
<table>
    <thead>
    <tr>
        <th>Proposal ID</th>
        <th>Date</th>
        <th>Resolved Category</th>
        <th>Sample Description</th>
        <th>Assigned By</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody>
    {% for item in proposals %}
    <tr class="proposal">
        <td>#{{ item.pk }}</td>
        <td>{{ item.resolution_date|date:"Y-m-d H:i" }}</td>
        <td>
            <strong>{{ item.resolved_point }}</strong>
            <br><small>({{ item.transaction.amount }} {{ item.transaction.currency }})</small>
        </td>
        <td>
            {{ item.transaction.description|truncatechars:100 }}
            <br>
            <small>From Declaration: {{ item.transaction.statement.declaration.name }}</small>
        </td>
        <td>{{ item.assigned_user.username }}</td>
        <td>
            <a href="{% url 'finalize_rule' item.pk %}"
               style="background-color: #007bff; color: white; padding: 5px 10px; text-decoration: none; border-radius: 3px;">
                Review & Finalize Rule
            </a>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p style="color: green; margin-top: 20px;">âœ… No new rule proposals are currently awaiting review.</p>
{% endif %}
</body>
</html>
